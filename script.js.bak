// Generate stars
function createStars() {
    const starsContainer = document.querySelector('.stars-container');
    const starCount = 100;
    
    for (let i = 0; i < starCount; i++) {
        const star = document.createElement('div');
        star.className = 'star';
        
        // Random position
        const x = Math.random() * 100;
        const y = Math.random() * 100;
        star.style.left = x + '%';
        star.style.top = y + '%';
        
        // Random animation delay (2-5 seconds)
        const delay = Math.random() * 3;
        const duration = 2 + Math.random() * 3;
        star.style.animationDelay = delay + 's';
        star.style.animationDuration = duration + 's';
        
        starsContainer.appendChild(star);
    }
}

// Scroll effect for logo
function handleScroll() {
    const logoBackground = document.getElementById('logoBackground');
    const scrollY = window.scrollY;
    const windowHeight = window.innerHeight;
    
    // Calculate opacity based on scroll position
    // Logo starts fading when scrolled past 20% of viewport height
    const fadeStart = windowHeight * 0.2;
    const fadeEnd = windowHeight * 0.8;
    
    if (scrollY <= fadeStart) {
        logoBackground.style.opacity = 1;
    } else if (scrollY >= fadeEnd) {
        logoBackground.style.opacity = 0;
    } else {
        // Linear interpolation
        const fadeProgress = (scrollY - fadeStart) / (fadeEnd - fadeStart);
        logoBackground.style.opacity = 1 - fadeProgress;
    }
}

// Smooth scroll for navigation links and auto-expand sections
function setupSmoothScroll() {
    const navLinks = document.querySelectorAll('.nav-card');
    
    navLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            const targetId = this.getAttribute('href');
            const targetSection = document.querySelector(targetId);
            
            if (targetSection) {
                const headerOffset = 100;
                const elementPosition = targetSection.getBoundingClientRect().top;
                const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
                
                // Check if section is collapsible and expand it
                if (targetSection.classList.contains('collapsible')) {
                    const sectionHeader = targetSection.querySelector('.section-header');
                    const sectionContent = targetSection.querySelector('.section-content');
                    
                    if (sectionContent && sectionContent.classList.contains('collapsed')) {
                        toggleSection(sectionHeader);
                    }
                }
                
                window.scrollTo({
                    top: offsetPosition,
                    behavior: 'smooth'
                });
            }
        });
    });
}

// Toggle collapsible sections
function toggleSection(header) {
    const section = header.parentElement;
    const content = section.querySelector('.section-content');
    const isExpanded = content.classList.contains('expanded');
    
    if (isExpanded) {
        content.classList.remove('expanded');
        content.classList.add('collapsed');
        header.classList.remove('open');
    } else {
        content.classList.remove('collapsed');
        content.classList.add('expanded');
        header.classList.add('open');
    }
}

// Contenido de roles
const ROLES_CONTENT = `ğŸ‘‘ Admin

Fundador y mÃ¡xima autoridad del clan.
Vigila el cumplimiento de las normas, la unidad del grupo y la visiÃ³n de Avellanark.
Sus decisiones son definitivas y buscan siempre el bien comÃºn del clan.

ğŸ•¯ï¸ Consejeros Mayores

Sabios de la orden.
Asisten al Admin en la toma de decisiones importantes y velan por la armonÃ­a entre los miembros.
Su palabra guÃ­a el rumbo del clan en momentos de duda o conflicto.

ğŸ›¡ï¸ Ayudante

Mano derecha de los Guardianes y Vanguardia.
Apoya en la organizaciÃ³n interna, registro de miembros, resoluciÃ³n de dudas y coordinaciÃ³n de eventos.
Representan la voz del pueblo ante los altos rangos.

âš”ï¸ Capitanes de la Guardia Real

LÃ­deres en el campo de batalla.
Supervisan a los Guardias Reales, planifican estrategias y defienden el honor de Avellanark.
Su deber es proteger al clan de amenazas externas y mantener el orden interno.

ğŸ›¡ï¸ Guardias Reales

Defensores Ã©lite del clan.
Custodian a los miembros de rango inferior y aseguran la paz en los canales.
Son sÃ­mbolo de disciplina, lealtad y fuerza.

âš’ï¸ Soldados

El corazÃ³n del clan.
Participan activamente en misiones, guerras, eventos y actividades conjuntas.
Su compromiso en batalla demuestra el valor del espÃ­ritu Avellanark.

ğŸ—ï¸ Capitanes Constructores

Maestros del diseÃ±o y la creaciÃ³n.
Dirigen proyectos arquitectÃ³nicos, supervisan construcciones y entrenan a los nuevos constructores.
Sus obras levantan los cimientos del legado Avellanark.

ğŸª“ Constructores

Manos que dan forma al reino.
Se encargan de edificar, decorar y mantener las estructuras del clan.
Su trabajo refleja el ingenio y la uniÃ³n de la hermandad.

ğŸŒ¾ Farmer

Proveedores y guardianes de los recursos.
Cultivan, recolectan y administran los materiales esenciales para la supervivencia y prosperidad del clan.
Sin ellos, el reino no florece.

ğŸ¤ Hermano

Miembro pleno de la comunidad.
Ha demostrado compromiso, respeto y fidelidad al clan.
Participa activamente en eventos y decisiones colectivas.
Ser Hermano es un honor ganado, no otorgado.

ğŸ”° Aspirante

Nuevo miembro en camino a la hermandad.
Aprende las costumbres, valores y reglas del clan.
Su conducta y participaciÃ³n determinarÃ¡n su ascenso.

ğŸŒ‘ Desaparecido

Miembro inactivo o ausente por tiempo prolongado.
Mantiene su rango simbÃ³licamente, pero no participa de las decisiones ni actividades del clan.
Puede ser reintegrado al volver con compromiso renovado.`;

function loadRoles() {
    const rolesContainer = document.getElementById('roles-content');
    const lines = ROLES_CONTENT.split('\n');
        let html = '';
        let inRole = false;
        
        for (let i = 0; i < lines.length; i++) {
            const line = lines[i].trim();
            
            // Check if line is a role title (starts with emoji or specific patterns)
            if (line.match(/^[ğŸ‘‘ğŸ•¯ï¸ğŸ›¡ï¸âš”ï¸âš’ï¸ğŸ—ï¸ğŸª“ğŸŒ¾ğŸ¤ğŸ”°ğŸŒ‘]/)) {
                if (inRole) {
                    html += '</div>';
                }
                inRole = true;
                html += '<div class="role-item"><div class="role-title">' + line + '</div>';
            } else if (inRole && line !== '') {
                html += '<div class="role-description">' + line + '</div>';
            }
        }
        
        if (inRole) {
            html += '</div>';
        }
        
        rolesContainer.innerHTML = html;
    } catch (error) {
        console.error('Error loading roles:', error);
        document.getElementById('roles-content').innerHTML = '<p>Error al cargar los roles.</p>';
    }
}

// Contenido de reglas
const REGLAS_CONTENT = `ğŸ“œ Reglas Oficiales del Clan Avellanark


ğŸ›¡ï¸ 1. Respeto sobre todo

El respeto es el pilar fundamental de nuestra comunidad.
En Avellanark somos hermanos, no sÃºbditos.

Queda terminantemente prohibido el uso de insultos, expresiones discriminatorias, acoso o cualquier forma de ataque personal, directo o indirecto.

Toda diferencia debe resolverse mediante el diÃ¡logo y con la intervenciÃ³n de un GuardiÃ¡n o miembro de la Vanguardia si es necesario.

ğŸš« 2. ComunicaciÃ³n responsable

Para mantener la armonÃ­a y fluidez en los canales:

Prohibido el spam o flood, incluyendo mensajes repetidos, emojis excesivos o envÃ­os masivos de texto.

No se permite el uso del chat con fines ajenos al clan o fuera del contexto del canal.

ğŸ“¢ 3. Publicidad y enlaces

EstÃ¡ prohibido promocionar otros servidores, clanes, redes sociales o proyectos externos sin autorizaciÃ³n expresa de un GuardiÃ¡n.

Se prohÃ­be compartir enlaces maliciosos, sospechosos o de contenido no verificado.

Todo enlace compartido debe tener un propÃ³sito claro y relacionado con el clan.

ğŸ—‚ï¸ 4. Uso de canales

Cada canal tiene su funciÃ³n:
ğŸ’¬ Chat general â€” conversaciÃ³n cotidiana y anuncios.
ğŸ™ï¸ Voz y Estrategia â€” coordinaciÃ³n y comunicaciÃ³n en partidas.

Usar cada canal de acuerdo con su finalidad es obligatorio.

El mal uso reiterado podrÃ¡ derivar en advertencias o sanciones.

ğŸš· 5. Contenido permitido

En el Clan Avellanark no se permite ningÃºn tipo de contenido:
âŒ NSFW (sexual o sugerente)
âŒ Gore o violencia explÃ­cita
âŒ Ilegal o inapropiado
âŒ PolÃ­tico o religioso que genere conflicto

MantÃ©n siempre un entorno seguro, apto para todos los miembros.

ğŸ§ 6. Convivencia en voz

Para una comunicaciÃ³n fluida y respetuosa:

Respeta los turnos de palabra y evita interrumpir.

No generes ruidos molestos ni pongas mÃºsica sin consentimiento del grupo.

El uso de distorsionadores de voz, sonidos molestos o abuso del micrÃ³fono serÃ¡ sancionado.

ğŸ° 7. JerarquÃ­a del clan

El Clan se estructura en los siguientes rangos:
Aspirante â†’ Hermano â†’ Vanguardia â†’ GuardiÃ¡n

Los Guardianes y la Vanguardia son responsables de mantener el orden y hacer cumplir estas normas.

Sus decisiones deben ser respetadas.

Los ascensos se basan en mÃ©rito, compromiso y conducta, no en favoritismos o vÃ­nculos personales.

ğŸ” 8. Seguridad y cuentas

Se prohÃ­be el uso de mÃºltiples cuentas o suplantaciÃ³n de identidad.

Cada miembro debe proteger su cuenta con medidas de seguridad (como 2FA).

El incumplimiento podrÃ¡ conllevar expulsiÃ³n inmediata del clan.

ğŸ”¥ 9. EspÃ­ritu Avellanark

Participar, aportar ideas y apoyar a los compaÃ±eros es parte del camino de un verdadero hermano.
La fuerza del clan reside en su uniÃ³n, su lealtad y su honor.
âš”ï¸ Juntos forjamos el futuro del Clan Avellanark. âš”ï¸`;

function loadReglas() {
    const reglasContainer = document.getElementById('reglas-content');
    const lines = REGLAS_CONTENT.split('\n');
        let html = '';
        let inRegla = false;
        let headerAdded = false;
        
        for (let i = 0; i < lines.length; i++) {
            const line = lines[i].trim();
            
            // Skip the main header line
            if (!headerAdded && line.startsWith('ğŸ“œ')) {
                html += '<div class="regla-header">' + lines[i].trim() + '</div>';
                headerAdded = true;
                continue;
            }
            
            // Check if line is a regla title (starts with specific emoji patterns for numbered rules or special cases)
            if (line.match(/^[ğŸ›¡ï¸ğŸš«ğŸ“¢ğŸ—‚ï¸ğŸš·ğŸ§ğŸ°ğŸ”ğŸ”¥]\s*[0-9]/) && !line.includes('Reglas Oficiales')) {
                if (inRegla) {
                    html += '</div>';
                }
                inRegla = true;
                html += '<div class="regla-item"><div class="regla-title">' + lines[i].trim() + '</div>';
            } else if (line.startsWith('âš”ï¸') && line.length > 10 && !line.includes('Reglas Oficiales')) {
                // Handle special closing line
                html += '<div class="regla-description">' + lines[i].trim() + '</div>';
            } else if (inRegla && line !== '' && !line.startsWith('ğŸ“œ')) {
                html += '<div class="regla-description">' + line + '</div>';
            }
        }
        
        if (inRegla) {
            html += '</div>';
        }
        
        reglasContainer.innerHTML = html;
    } catch (error) {
        console.error('Error loading reglas:', error);
        document.getElementById('reglas-content').innerHTML = '<p>Error al cargar las reglas.</p>';
    }
}

// Initialize on page load
document.addEventListener('DOMContentLoaded', function() {
    createStars();
    setupSmoothScroll();
    loadRoles();
    loadReglas();
    
    // Add scroll event listener
    window.addEventListener('scroll', handleScroll);
    
    // Initial opacity check
    handleScroll();
});

